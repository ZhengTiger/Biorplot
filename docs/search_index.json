[["index.html", "Biorplot Documentation Chapter 1 Installation &amp; Usage 1.1 Dependence 1.2 example", " Biorplot Documentation Zheng Hu 2022-04-14 Chapter 1 Installation &amp; Usage You can download the package from Biorplot GitHub Page: git clone https://github.com/zhenghu159/Biorplot.git Then load the package by: source(&#39;Biorplot.R&#39;) 1.1 Dependence You should install these dependence: scales, ggsci, ggthemes, ggplot2, cowplot, ggrepel install.packages(c(&quot;scales&quot;,&quot;ggsci&quot;,&quot;ggthemes&quot;,&quot;ggplot2&quot;,&quot;cowplot&quot;,&quot;ggrepel&quot;)) 1.2 example Basic Plot scRNAseq Plot NGS Plot "],["basic-plot.html", "Chapter 2 Basic Plot 2.1 Bior_Sankey 2.2 Bior_pie 2.3 Bior_StackBarplot 2.4 Bior_Line", " Chapter 2 Basic Plot Some basic plots commonly used 2.1 Bior_Sankey Description sankey plot based on networkD3::sankeyNetwork(), you can use Nodes.colour and Nodes.order to set Nodes colour and order, this function will automatically remove links$value==0 rows Usage Bior_Sankey(links, Nodes.colour=NULL, Nodes.order=NULL, fontSize=12,nodeWidth=30, nodePadding=10, margin=NULL, height=600, width=600, sinksRight=TRUE) Arguments * links: A dataframe, colnames must have ‘source’ ‘target’ ‘value’ * Nodes.colour: Set nodes colour * Nodes.order: Set nodes order * fontSize: Set fontsize * nodeWidth: Set nodewidth * nodePadding: Set the gap size between nodes * margin: R margin * height: numeric height for the network graph’s frame area in pixels * width: numeric width for the network graph’s frame area in pixels * sinksRight: boolean. If TRUE, the last nodes are moved to the right border of the plot Examples # first you should install and library networkD3 packages install.packages(&quot;networkD3&quot;) library(networkD3) # links data, colnames must have &#39;source&#39; &#39;target&#39; &#39;value&#39; links &lt;- data.frame( source=c(&quot;C&quot;,&quot;A&quot;, &quot;B&quot;, &quot;E&quot;, &quot;D&quot;), target=c(&quot;b&quot;,&quot;c&quot;, &quot;a&quot;, &quot;e&quot;, &quot;d&quot;), value=c(1, 2, 0, 4, 5) ) links source target value 1 C b 1 2 A c 2 3 B a 0 4 E e 4 5 D d 5 # Set Nodes order and colour Nodes.order &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;) Nodes.colour &lt;- pal_d3(&quot;category20&quot;, alpha = 0.7)(20) p &lt;- Bior_Sankey(links, Nodes.order=Nodes.order, Nodes.colour=Nodes.colour, fontSize=20) p # Use saveNetwork() to save the plot as html saveNetwork(p,&quot;sankey.html&quot;) 2.2 Bior_pie Description Pie plot based on ggplot Usage Bior_pie(x, labels, col=pal_d3(“category20,”alpha=0.7)(20), title=““, fontsize=20, legend.key.size=1) Arguments * x: A vector of value * labels: A vector of labels for x * col: colour * title: title * fontsize: fontsize * legend.key.size: legend size Examples x &lt;- c(3,7,9,1,2) labels &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;) col &lt;- c(&quot;#AEC7E8B2&quot;, &quot;#FFBB78B2&quot;, &quot;#98DF8AB2&quot;, &quot;#FF9896B2&quot;, &quot;#C5B0D5B2&quot;) p &lt;- Bior_pie(x, labels, col=col, title=&quot;Test Bior_pie&quot;) p 2.3 Bior_StackBarplot Description Stacked Barplot based on ggplot Usage Bior_StackBarplot(data, x.order=NULL, type.order=NULL, col=category20, label.size=5, labs.x=’‘, labs.y=’‘, title=’’, legend.key.size=1, text.size=15, bar.width=0.7, theme=theme_bw()) Arguments * data: A dataframe, the columns are x-axis sample, the rows are fill type * x.order: x axis sample order * type.order: fill type order * col:fill colours * label.size: label size * labs.x: x axis title * labs.y: y axis title * title: figure title * legend.key.size: legend size * text.size: text size * bar.width: bar width * theme: choose ggthemes, eg:theme_bw(), theme_classic() Examples data &lt;- data.frame(matrix(rnorm(20, mean = 20, sd = 5),c(4,5))) data &lt;- round(data) rownames(data) &lt;- paste(&#39;gene&#39;,1:4, sep=&#39;&#39;) colnames(data) &lt;- paste(&#39;sample&#39;,1:5,sep=&#39;&#39;) x.order &lt;- c(&#39;sample1&#39;,&#39;sample5&#39;,&#39;sample4&#39;,&#39;sample3&#39;,&#39;sample2&#39;) type.order &lt;- c(&#39;gene1&#39;,&#39;gene2&#39;,&#39;gene3&#39;,&#39;gene4&#39;) col &lt;- pal_d3(&quot;category20&quot;)(20)[11:20] p &lt;- Bior_StackBarplot(data, x.order=x.order, type.order=type.order, col = col, labs.x=&#39;Samples&#39;, labs.y=&#39;Numbers&#39;, title=&#39;Test Bior_StackBarplot&#39;, theme=theme_minimal()) p 2.4 Bior_Line Description Line plot based on ggplot Usage Bior_Line(data, line.size=1.5, labs.x=’‘, labs.y=’‘, title=’‘, text.size=20, title.size=30, legend.position=’right,’ col=category20, vline=0, theme=theme_minimal()) Arguments * data: A dataframe, first column is x, second column is y, third column is Type * line.size: line size * labs.x: labs x * labs.y: labs y * title: title * title.size: title size * legend.position: legend position, you can choose one in {‘left,’‘top,’‘right,’ ‘bottom,’‘none’} * col: color * vline: geom_vline xintercept * theme: choose ggthemes, default:theme_minimal() Examples data &lt;- data.frame(&#39;x&#39; = c(1:20), &#39;y&#39; = rnorm(20), &#39;Type&#39; = rep(c(&#39;A&#39;,&#39;B&#39;), 10)) col &lt;- c(&quot;#f89588&quot;,&quot;#63b2ee&quot;) p &lt;- Bior_Line(data, title = &#39;Test Bior_Line&#39;, col = col) p "],["scrnaseq-plot.html", "Chapter 3 scRNAseq Plot 3.1 Bior_DimPlot 3.2 Bior_FeatureVlnplot 3.3 Bior_DoHeatmap 3.4 Bior_Featurebox", " Chapter 3 scRNAseq Plot Some plots commonly used in scRNAseq analysis. The test data used in Examples is Seurat Tutorial Data # first you should install and library Seurat packages install.packages(&quot;Seurat&quot;) library(Seurat) # load test data seuratobject &lt;- readRDS(&quot;testdata/pbmc3k_final.rds&quot;) 3.1 Bior_DimPlot Description Plot based on Seurat::DimPlot() Usage Bior_DimPlot(seuratobject, reduction=“umap,” pt.size=1, label = TRUE, label.size=5, cols=NULL, group.by=NULL, legend.key.size=1, text.size=15, cells.highlight = NULL, cols.highlight=‘#f8cb7f,’ sizes.highlight=1) Arguments * seuratobject: Seurat object * reduction: Choose “umap” or “tsne” * pt.size: Adjust cell point size * label: Whether to label the clusters * label.size: Sets size of labels * cols: colors * group.by: Name of one or more metadata columns to group (color) cells * legend.key.size: legend size * text.size: text size * cells.highlight: A list of character or numeric vectors of cells to highlight * cols.highlight: A vector of colors to highlight the cells as * sizes.highlight: Size of highlighted cells Examples cols &lt;- pal_d3(&quot;category20&quot;)(20) p &lt;- Bior_DimPlot(seuratobject, reduction=&#39;umap&#39;, cols = cols) p # highlight cell highlight_cell &lt;- names(seuratobject@active.ident)[which(seuratobject@active.ident==&#39;Naive CD4 T&#39;)] p &lt;- Bior_DimPlot(seuratobject, reduction=&#39;umap&#39;, text.size=20, cells.highlight=highlight_cell, cols.highlight=&#39;#f8cb7f&#39;, sizes.highlight=1, pt.size=1, cols=&#39;#90a5e1&#39;, label = F) p 3.2 Bior_FeatureVlnplot Description Simultaneously plot multiple genes Featureplot and Vlnplot Usage Bior_FeatureVlnplot(seuratobject, genes, title.size=15, axis.text.size=10, pt.size=1, nrow=1, scale=1, cols=NULL,reduction=‘umap’) Arguments * seuratobject: Seurat object * genes: Multiple genes vectors, eg: c(“MS4A1,” “GNLY,” “CD3E”) * title.size: title gene name size * axis.text.size: x-axis text size * pt.size: Featureplot point size * nrow: Number of rows in the plot grid * scale: scale the size of all or select plots * cols: Vlnplot cluster colors * reduction: Choose “umap” or “tsne” Examples genes &lt;- c(&quot;MS4A1&quot;, &quot;GNLY&quot;, &quot;CD3E&quot;, &quot;CD14&quot;, &quot;FCER1A&quot;, &quot;FCGR3A&quot;) cols &lt;- pal_d3(&quot;category20&quot;)(20) p &lt;- Bior_FeatureVlnplot(seuratobject, genes, scale=0.8, pt.size=0.5, nrow=2, cols=cols) p 3.3 Bior_DoHeatmap Description Plot based on Seurat::DoHeatmap() Usage Bior_DoHeatmap(seuratobject, features, group.by=“ident,” group.bar=TRUE, group.colors=NULL, group.size=5, group.label=TRUE, gene.size=5, gene.label=TRUE, margin=margin(0,0,0,0)) Arguments * seuratobject: Seurat object * features: A vector of top genes * group.by: A vector of variables to group cells by; pass ‘ident’ to group by cell identity classes * group.bar: Add a color bar showing group status for cells * group.colors: Colors to use for the color bar * group.size: Size of text above color bar * group.label: Label the cell identies above the color bar * gene.size: gene label size * gene.label: whether to show gene label * margin: R margin Examples library(dplyr) pbmc.markers &lt;- FindAllMarkers(seuratobject, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25) top10 &lt;- pbmc.markers %&gt;% group_by(cluster) %&gt;% top_n(n = 10, wt = avg_log2FC) cols &lt;- pal_d3(&quot;category20&quot;)(20) p &lt;- Bior_DoHeatmap(seuratobject, top10$gene, group.colors=cols, group.size=3, gene.label=F, margin=margin(20,20,0,0)) p 3.4 Bior_Featurebox Description Plot cluster feature boxplot Usage Bior_Featurebox(seuratobject, feature, text.size=18, hline.min=NULL, hline.size=NA, cols=NULL) Arguments * seuratobject: Seurat object * feature: seurate feature * text.size: text size * hline.min: geom_hline yintercept * hline.size: geom_hline size * cols: cluster colors Examples cols &lt;- pal_d3(&quot;category20&quot;)(20) P &lt;- Bior_Featurebox(seuratobject, feature = &#39;nFeature_RNA&#39;, cols = cols) P "],["ngs-plot.html", "Chapter 4 NGS Plot 4.1 Bior_Volcano", " Chapter 4 NGS Plot Some plots commonly used in NGS analysis. 4.1 Bior_Volcano Description Volcano plot Usage Bior_Volcano(gene, logfc, pvalue, label.gene=’‘, label.size=5, logfc.threshold.up=1, logfc.threshold.Down=-1, pvalue.threshold=0.01, point.size=2, point.shape= 20, fontsize=20, title=’‘, limits.x=c(-10,10), limits.y=c(0,15), legend.position=’right,’ color=c(‘#2f5688,’‘#BBBBBB,’‘#CC0000’)) Arguments * gene: RNAseq gene * logfc: RNAseq log2FoldChange * pvalue: RNAseq pvalue * label.gene: a vector of gene to label * label.size: gene label size * logfc.threshold.up: log2FoldChange threshold for up genes * logfc.threshold.Down: log2FoldChange threshold for down genes * pvalue.threshold: pvalue threshold for differential genes * point.size: point size * point.shape: point shape * fontsize: fontsize * title: title * limits.x: x-axis range * limits.y: y-axis range * legend.position: legend position, you can choose one in {‘left,’‘top,’‘right,’ ‘bottom,’‘none’} * color: point color Examples data &lt;- read.table(&#39;testdata/Bior_Volcano.txt&#39;, header=T) gene &lt;- data$Gene logfc &lt;- data$log2FoldChange pvalue &lt;- data$pvalue label.gene &lt;- c(&#39;DOK6&#39;,&#39;TBX5&#39;,&#39;EMILIN2&#39;) p &lt;- Bior_Volcano(gene, logfc, pvalue, label.gene, label.size=5, title=&quot;Test Bior_Volcano&quot;, legend.position=&quot;none&quot;, limits.x=c(-3,3),limits.y=c(0,10)) p "],["data-analysis.html", "Chapter 5 Data Analysis 5.1 Bior_Dim2to1 5.2 Bior_Combn", " Chapter 5 Data Analysis Some useful transformat functions in data analysis. 5.1 Bior_Dim2to1 Description Conver a two-dimensional dataframe to one-dimension, often used to adjust data format before plot. Usage Bior_Dim2to1(data) Arguments * data: a two-dimensional dataframe Examples data &lt;- matrix(c(1:9), nrow = 3, ncol = 3) colnames(data) &lt;- c(&#39;A&#39;,&#39;B&#39;,&#39;C&#39;) rownames(data) &lt;- c(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) data A B C a 1 4 7 b 2 5 8 c 3 6 9 df &lt;- Bior_Dim2to1(data) df row col value 1 a A 1 2 a B 4 3 a C 7 4 b A 2 5 b B 5 6 b C 8 7 c A 3 8 c B 6 9 c C 9 5.2 Bior_Combn Description Generate all combinations of the elements of inputdata. Usage Bior_Combn(inputdata) Arguments * inputdata: a vector Examples inputdata &lt;- c(&#39;A&#39;,&#39;B&#39;,&#39;C&#39;) motifs &lt;- Bior_Combn(inputdata) motifs [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;A+B&quot; &quot;A+C&quot; &quot;B+C&quot; &quot;A+B+C&quot; "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
